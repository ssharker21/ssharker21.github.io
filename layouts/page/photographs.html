{{ define "main" }}
<article class="photographs-page max-w-2xl mx-auto p-6">
    <h1 class="post-title text-2xl font-bold mb-4">{{ .Title }}</h1>
    <div class="post-content mb-8">
        {{ .Content }}
    </div>

    <div class="photo-grid">
        {{ range .Resources.ByType "image" }}
        <div class="photo-item">
            <button class="image-button" onclick="openLightbox('{{ .RelPermalink }}')"
                aria-label="View full size image">
                <img src="{{ .RelPermalink }}" alt="{{ .Name }}" class="grid-image">
            </button>
        </div>
        {{ end }}
    </div>
</article>

<!-- Lightbox Modal -->
<div id="lightbox" class="lightbox" onclick="closeLightbox()">
    <span class="close-btn" onclick="closeLightbox()">&times;</span>
    <img class="lightbox-content" id="lightbox-img">
</div>

<script>
    function openLightbox(src) {
        var lightbox = document.getElementById("lightbox");
        var lightboxImg = document.getElementById("lightbox-img");
        if (lightbox && lightboxImg) {
            lightbox.style.display = "flex";
            lightboxImg.src = src;
            document.body.style.overflow = "hidden"; // Prevent scrolling
        }
    }

    function closeLightbox() {
        var lightbox = document.getElementById("lightbox");
        if (lightbox) {
            lightbox.style.display = "none";
            document.body.style.overflow = "auto"; // Restore scrolling
        }
    }

    // Close on escape key
    document.addEventListener('keydown', function (event) {
        if (event.key === "Escape") {
            closeLightbox();
        }
    });
</script>
{{ end }}